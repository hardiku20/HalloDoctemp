@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    Layout = "_AdminLayout";
}


@model learning1.DBEntities.ViewModel.AccountAccessViewModel;

@* Content of the Web-page *@
<div class="container pb-4">
    <div class="d-flex justify-content-between my-4">
        <h4 class="">Account Access</h4>
    </div>


    <div class="card border-0 shadow-sm">
        <div class="card-body p-0">
            <div class="d-flex justify-content-end align-items-center mb-2 p-2">
                <a asp-action="CreateRole" asp-controller="Admin"
                    class="btn btn-outline-info font-info text-decoration-none text-info fs-6 bg-white dark-mode1 d-flex align-items-center gap-1">
                    Create Role
                </a>
            </div>


            <div class="">
                <table class="table-responsive  table-hover w-100">
                    <tr class="border-bottom border-secondary-subtle bg-secondary-subtle">
                        <td scope="col" class="py-3 ps-4">Name</td>
                        <td scope="col" class="py-3">Account Type</td>
                        <td scope="col" class="py-3 d-flex justify-content-center">Actions</td>
                    </tr>


                    @foreach (var items in Model.Roledata)
                    {
                        <tr class="border-bottom border-secondary-subtle">
                            <td class="ps-4 py-1">@items.Name</td>
                            @{
                                Dictionary<int, string> AccountTextMap = new Dictionary<int, string>
                        {
                        { 0, "All" },
                        { 1, "Admin" },
                        { 2, "Physician" },
                        { 3, "Patient" },
                        // Add more mappings as needed
                        };
                            }
                            <td class="py-1">@AccountTextMap[items.AccountType]</td>
                            <td class="d-flex justify-content-center gap-1 py-1">
                                <a type="submit" class="btn btn-outline-info text-info bg-white dark-mode1" asp-action="EditRole" asp-controller="Admin" asp-route-RoleId="@items.RoleId" asp-route-AccountType="@items.AccountType">Edit</a>
                                <button type="submit" class="btn btn-outline-info text-info bg-white dark-mode1" onclick="DeleteRole(@items.RoleId)">Delete</button>
                            </td>
                        </tr>
                    }
                </table>
            </div>
        </div>
    </div>
</div>


<script>
    function DeleteRole(id) {
        var response = confirm("Are you sure to delete the record?");
        if (response) {

            $.ajax({
                method: "post",
                url: '/Admin/DeleteRole',
                data: {
                    RoleId: id,
                },
                success: function () {
                    window.location.reload();
                },
                error: function (error) {
                    console.log(error);
                }
            });
        }
    }
</script>